'use strict';

const gistApi = require('gisthrower-api');
const chalk = require('chalk');
const util = require('util');

const usingOptions = (options) => {
  if (options.all) {
    return true;
  }
  return false;
};

const formatToPrint = (chunk) => {
  const format = (gistChunk) => {
    let delimiter = chalk.white('+'.concat((Array(59).join('-')), '+'));
    let title = chalk.bold.green('+ Gist \''.concat(gistChunk.description, '\' | Id: ', gistChunk.id));
    let body = chalk.bold.green((!!gistChunk.public ? '+ Public' : '+ Private').concat(' Url: ', gistChunk.html_url));
    let end = chalk.bold.green.bgYellow('+ Pull url: ' + gistChunk.git_pull_url);
    return delimiter.concat('\n', title, '\n', body, '\n', end, '\n', delimiter);
  };

  return chunk.map(format);
};

const list = (options) => {
  if (usingOptions(options)) {
    console.log('do something using options');
  };

  gistApi.listAll()
    .then((chunk) => {
      const pritableArray = formatToPrint(chunk);
      pritableArray.forEach((gist) => { console.log(gist); });
    })
    .catch((error) => {
      const message = chalk.red.bgYellow.bold(error);
      console.log(message);
    });
};

module.exports = list;
